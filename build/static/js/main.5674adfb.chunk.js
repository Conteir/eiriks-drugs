(this["webpackJsonpsnomed-search"]=this["webpackJsonpsnomed-search"]||[]).push([[0],{33:function(e,t,n){e.exports=n(59)},42:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),s=n.n(c),l=n(12),o=n(10),u=n(2),i=n(21),m=n.n(i),d=n(26),f=n(8),p=n(32),g=n(5),h=n(28),v={headers:{Accept:"application/json","Accept-Language":"nb-NO,no,nb;q=0.9,nn;q=0.8,en-US;q=0.7,en-GB;q=0.6","Content-Type":"application/json"},method:"GET"},E=function(e){return e.ok?e.json():Promise.reject(new Error("Failed to load data from server"))},b=["https://test.terminologi.ehelse.no","https://qa.terminologi.ehelse.no","https://terminologi.ehelse.no"],N=[],O=["nb-NO","nb","nn","no"],S=function(e,t){return Promise.all(N.map((function(n){var a=n.id,r=n.branch,c=new URL("browser/".concat(r,"/members"),e);return c.searchParams.set("limit","3"),c.searchParams.set("active","true"),c.searchParams.set("referenceSet",a),c.searchParams.set("referencedComponentId",t),fetch(c.toString(),v).then((function(e){return E(e)}))})))},C=function(e,t,n){var a=new URL("".concat(t,"/descriptions"),e);return a.searchParams.set("conceptId",n),a.searchParams.set("offset","0"),a.searchParams.set("limit","3"),fetch(a.toString(),v).then((function(e){return E(e)}))},j=function(e,t,n){var a=new URL("browser/".concat(t,"/descriptions"),e);return a.searchParams.set("limit","3"),a.searchParams.set("active","true"),a.searchParams.set("groupByConcept","true"),a.searchParams.set("language","no"),a.searchParams.append("language","nb-NO"),a.searchParams.append("language","nb"),a.searchParams.append("language","nn"),a.searchParams.append("language","en"),a.searchParams.set("conceptActive","true"),a.searchParams.set("conceptActive","true"),a.searchParams.set("semanticTag","substance"),a.searchParams.set("term",n),fetch(a.toString(),v).then((function(e){return E(e)}))},y=function(e){var t=new URL("branches",e);return fetch(t.toString(),v).then((function(e){return E(e)})).then((function(e){return e.filter((function(e){return e.containsContent}))}))},A=function(e,t,n){var a=new URL("".concat(t+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"387264003";return"/concepts?ecl=<<736479009:R736474004=(*:R411116001=(<<763158003:762949000=("+e+" OR (<<261217004:738774007="+e+"))))"}(n)),e);return fetch(a.toString(),v).then((function(e){return E(e)}))},I=function(e,t){var n=new URL("".concat(t+"/concepts?ecl=%3C736478001%20Minus%20%3C!736478001"),e);return fetch(n.toString(),v).then((function(e){return E(e)}))},R=function(e,t,n){var a=new URL("".concat(t+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"387264003";return"/concepts?ecl=%3C%3C736480007%3A%20R736475003%3D(*%3AR411116001%3D(%3C%3C763158003%3A762949000%3D("+e+"%20OR%20(%3C%3C261217004%3A738774007%3D"+e+"))))"}(n)),e);return fetch(a.toString(),v).then((function(e){return E(e)}))},k=function(e,t,n){var a=new URL("".concat(t+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"387264003";return"/concepts?ecl=%3C%3C736665006%3A%20R736472000%3D(*%3AR411116001%3D(%3C%3C763158003%3A762949000%3D("+e+"%20OR%20(%3C%3C261217004%3A738774007%3D"+e+"))))"}(n)),e);return fetch(a.toString(),v).then((function(e){return E(e)}))},w=(n(42),function(){return r.a.createElement("div",{className:"spinner-border loading text-secondary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))}),F=function(e){var t=e.host,n=e.branch,a=e.preferredTerm,c=e.conceptId,s=(Object(g.useAsync)(C,[t,n,c]).result||{}).items,l=void 0===s?[]:s;return r.a.createElement(r.a.Fragment,null,l.filter((function(e){return"SYNONYM"===e.type})).filter((function(e){var t=e.lang;return O.includes(t)})).filter((function(e){return e.term!==a})).map((function(e){var t=e.term,n=e.descriptionId;return r.a.createElement("p",{key:n},t)})))},P=function(e){var t=e.host,n=e.branch,a=e.preferredTerm,c=(e.fullySpecifiedName,e.conceptId),s=(e.scope,Object(g.useAsync)(S,[t,c]));return r.a.createElement("div",{className:"d-md-flex justify-content-between"},r.a.createElement("div",null,r.a.createElement("p",null,a),r.a.createElement(F,{host:t,branch:n,conceptId:c,preferredTerm:a})),r.a.createElement("dl",{className:"mb-md-0 ml-md-5"},r.a.createElement("dd",{className:"mb-md-0"},c)),s.loading&&r.a.createElement(w,null))},T=function(e){var t=e.children;return r.a.createElement("div",{className:"alert alert-danger d-inline-block",role:"alert"},t)},D=function(e){var t,n=e.scope;return r.a.createElement("header",{className:"row"},r.a.createElement("div",null,r.a.createElement("h1",null,"SNOMED CT legemiddels\xf8k")),r.a.createElement("div",{className:"col"},r.a.createElement("nav",{className:"navbar navbar-expand mb-3"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",{className:(t="",t===n?"nav-item active":"nav-item")},r.a.createElement(l.b,{className:"nav-link",to:"/"},"Resett")),!1))))},M=n(13),q=n(14),U=n(16),V=n(15),L=n(17),x=function(e){function t(e){var n;return Object(M.a)(this,t),(n=Object(U.a)(this,Object(V.a)(t).call(this,e))).getDrugs=function(){n.props.genericUrl&&(console.log(n.props.genericUrl),fetch(n.props.genericUrl,{method:"GET"}).then((function(e){return e.json()})).then((function(e){var t=[];Array.isArray(e.items)&&e.items.forEach((function(e){var a=fetch(n.props.commercialUrl+e.conceptId,{method:"GET"}).then((function(e){return e.json()})).then((function(t){Array.isArray(t.items)&&(e.commercialItems=t.items)}));t.push(a)})),Promise.all(t).then((function(){n.setState({response:JSON.stringify(e,null,2)})}))})))},n.state={response:""},n}return Object(L.a)(t,e),Object(q.a)(t,[{key:"renderCommercial",value:function(e){return e.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("div",null,"Commercial drug ",r.a.createElement("span",null,t+1),":"," ",r.a.createElement("span",null,e.additionalFields.NavnFormStyrke," ",r.a.createElement("a",{href:"https://www.legemiddelsok.no/sider/default.aspx?searchquery="+e.additionalFields.ATCKode+"&f=Han;MtI;Vir;ATC;Var;Mar;Mid;Avr;gen;par;&pane=0"},"Legemiddels\xf8k"))," "))}))}},{key:"renderDrugs",value:function(){var e=this;if(this.state.response){var t=JSON.parse(this.state.response);if(console.log(t),Array.isArray(t.items))return t.items.map((function(t,n){return r.a.createElement("li",{key:n},r.a.createElement("div",null,"Generic drug ",r.a.createElement("span",null,n+1),": ",r.a.createElement("span",null,t.pt.term)," ",r.a.createElement("span",null,t.conceptId)),Array.isArray(t.commercialItems)?r.a.createElement("ul",null,e.renderCommercial(t.commercialItems)):null)}))}return null}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{onClick:this.getDrugs},"S\xf8k etter legemiddel")),r.a.createElement("div",null,r.a.createElement("ul",null,this.renderDrugs())))}}]),t}(r.a.Component),B=n(31),G=n.n(B),H=(n(58),function(e){function t(){var e;return Object(M.a)(this,t),(e=Object(U.a)(this,Object(V.a)(t).call(this))).getSuggestionValue=function(t){return e.props.suggestCallback(t.concept.conceptId),t.term},e.renderSuggestion=function(e){return r.a.createElement("div",null,e.term)},e.onSuggestionsFetchRequested=function(t){var n=t.value,a=n.trim().toLowerCase();if(a&&a.length>=3){var r=e.props.host+"/browser/"+e.props.branch+"/descriptions?limit=10&active=true&groupByConcept=true&language=no&language=nb-NO&language=nb&language=nn&language=en&conceptActive=true&semanticTag=substance&term="+n;fetch(r,{method:"GET"}).then((function(e){return e.json()})).then((function(t){if(Array.isArray(t.items)){var n=[];t.items.forEach((function(e){e.term&&e.term.length>0&&n.push(e)})),e.setState({suggestions:n})}}))}else e.setState({suggestions:[]})},e.onSuggestionsClearRequested=function(){e.setState({suggestions:[]})},e.onChange=function(t,n){var a=n.newValue;e.setState({value:a})},e.state={value:"",suggestions:[]},e}return Object(L.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){var e=this.state,t=e.value,n=e.suggestions,a={value:t,onChange:this.onChange};return r.a.createElement("div",null,r.a.createElement(G.a,{suggestions:n,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:this.getSuggestionValue,renderSuggestion:this.renderSuggestion,inputProps:a}))}}]),t}(r.a.Component)),J=function(e){var t=e.scope,n=function(){var e=Object(u.c)("q",u.b),t=Object(f.a)(e,2),n=t[0],a=t[1],r=Object(u.c)("h",u.b),c=Object(f.a)(r,2),s=c[0],l=c[1],o=Object(u.c)("b",u.b),i=Object(f.a)(o,2),v=i[0],E=i[1],b=Object(u.c)("is",u.b),N=Object(f.a)(b,2),O=N[0],S=N[1],C=Object(u.c)("f",u.b),y=Object(f.a)(C,2),A=y[0],I=y[1],R=Object(u.c)("r",u.b),k=Object(f.a)(R,2),w=k[0],F=k[1],P=Object(u.c)("a",u.b),T=Object(f.a)(P,2),D=T[0],M=T[1],q=Object(u.c)("s",u.b),U=Object(f.a)(q,2),V=U[0],L=void 0===V?"387264003":V,x=U[1],B=Object(h.a)((function(){return Object(p.a)(j,500)})),G=Object(g.useAsync)(Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s&&v&&n)){e.next=2;break}return e.abrupt("return",B(s,v,n||""));case 2:return e.abrupt("return",{});case 3:case"end":return e.stop()}}),e)}))),[n,v,O,A,w,D]);return{host:s,branch:v,query:n,form:A,rel:w,adm:D,intendedSite:O,searchRequest:G,conceptIdSubstance:L,setConceptIdSubstance:x,setBranch:E,setHost:l,setQuery:a,setIntendedSite:S,setForm:I,setAdm:M,setRel:F}}(),c=n.host,s=n.branch,l=n.setBranch,o=n.setHost,i=n.intendedSite,v=n.setIntendedSite,E=n.conceptIdSubstance,N=n.setConceptIdSubstance,O=n.rel,S=n.setRel,C=n.adm,F=n.setAdm,M=n.form,q=n.setForm,U=n.searchRequest,V=Object(g.useAsync)(y,[c||b[0]]);Object(a.useEffect)((function(){if(V.result&&!s){var e=(V.result.find((function(e){return"MAIN/SNOMEDCT-NO"===e.path}))||{}).path;e&&l(e)}}),[s,V,l]);var L=Object(g.useAsync)(A,[c||b[0],s||"MAIN/SNOMEDCT-NO",E]);Object(a.useEffect)((function(){if(L.result&&!i){var e=(L.result.items.find((function(e){return"666"===e.conceptId}))||{}).conceptId;e&&v(e)}}),[i,L,v]);var B=Object(g.useAsync)(k,[c||b[0],s||"MAIN/SNOMEDCT-NO",E]);Object(a.useEffect)((function(){if(B.result&&!C){var e=(B.result.items.find((function(e){return"666"===e.conceptId}))||{}).conceptId;e&&F(e)}}),[C,B,F]),console.log(C);var G=Object(g.useAsync)(R,[c||b[0],s||"MAIN/SNOMEDCT-NO",E]);Object(a.useEffect)((function(){if(G.result&&!O){var e=(G.result.items.find((function(e){return"666"===e.conceptId}))||{}).conceptId;e&&S(e)}}),[O,G,S]);var J=Object(g.useAsync)(I,[c||b[0],s||"MAIN/SNOMEDCT-NO"]);Object(a.useEffect)((function(){if(J.result&&!M){var e=(J.result.items.find((function(e){return"666"===e.conceptId}))||{}).conceptId;e&&q(e)}}),[M,J,q]),Object(a.useEffect)((function(){c||o(b[0])}),[c,o]);var Y;Y="739006009"===M?"736853009":"*";var K=V.result||[],Q=(U.result||{}).items,z=void 0===Q?[]:Q,W=(c||b[0])+"/"+(s||"MAIN/SNOMEDCT-NO")+"/concepts?ecl=<<763158003:762949000=("+E+" OR (<<105590001:738774007="+E+")),411116001=((<<736542009:736475003="+O+",736472000="+C+",736474004="+i+",736476002="+M+") OR (<<736542009:736475003="+O+",736472000="+C+",736474004="+i+",736476002="+M+",736473005= "+Y+"))",X=(c||b[0])+"/browser/MAIN%2FSNOMEDCT-NO%2FREFSETS/members?referenceSet=6021000202106&referencedComponentId=";return r.a.createElement("div",{className:"container"},r.a.createElement(D,{scope:t}),r.a.createElement("div",{className:"row mb-5"},r.a.createElement("div",{className:"col-9 col-md-10"},V.error&&r.a.createElement(T,null,V.error.message),!V.loading&&!V.error&&r.a.createElement("form",{onSubmit:function(e){e.preventDefault()}},r.a.createElement("div",{className:"form-row"},!t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"host"},"Host"),r.a.createElement("select",{id:"host",className:"form-control",value:c,onChange:function(e){o(e.target.value)}},b.map((function(e){return r.a.createElement("option",{value:e,key:e},e)}))))),r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"branch"},"Branch"),r.a.createElement("select",{id:"branch",className:"form-control",onChange:function(e){l(e.target.value)}},K.map((function(e){var t=e.path;return r.a.createElement("option",{value:t,key:t},t)})))))),r.a.createElement("div",{className:"col-md-12"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"query"},"Substans"),r.a.createElement(H,{host:c,branch:s,suggestCallback:N,onChange:function(e){N(e)},autoComplete:"off"}),r.a.createElement("section",{"aria-labelledby":"results"},r.a.createElement("ul",{className:"list-group"},z.map((function(e){var n=e.concept,a=n.conceptId,l=n.fsn.term,o=n.pt.term;return r.a.createElement("li",{key:a,className:"list-group-item mb-2"},r.a.createElement(P,{host:c||b[0],branch:s||"",preferredTerm:o,fullySpecifiedName:l,conceptId:a,scope:t}))})))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"Frigivelse"},"Frigivelse:"),r.a.createElement("select",{defaultValue:"",id:"rel",className:"form-control",onChange:function(e){S(e.target.value)}},r.a.createElement("option",{value:"",disabled:!0},"Velg"),G.result&&G.result.items.map((function(e){var t=e.pt,n=e.conceptId;return r.a.createElement("option",{value:n,key:t.term},t.term)}))))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"admMetode"},"Adm. metode"),r.a.createElement("select",{defaultValue:"",id:"adm",className:"form-control",onChange:function(e){F(e.target.value)}},r.a.createElement("option",{value:"",disabled:!0},"Velg"),B.result&&B.result.items.map((function(e){var t=e.pt,n=e.conceptId;return r.a.createElement("option",{value:n,key:t.term},t.term)}))))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"intendedSite"},"Intended site"),r.a.createElement("select",{defaultValue:"",id:"conceptIdSite",className:"form-control",onChange:function(e){v(e.target.value)}},r.a.createElement("option",{value:"",disabled:!0},"Velg"),L.result&&L.result.items.map((function(e){var t=e.pt,n=e.conceptId;return r.a.createElement("option",{value:n,key:t.term},t.term)}))))),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"form"},"Form"),r.a.createElement("select",{defaultValue:"",id:"form",className:"form-control",onChange:function(e){q(e.target.value)}},r.a.createElement("option",{value:"",disabled:!0},"Velg"),J.result&&J.result.items.map((function(e){var t=e.pt,n=e.conceptId;return r.a.createElement("option",{value:n,key:t.term},t.term)}))))))),r.a.createElement(x,{genericUrl:W,commercialUrl:X}),r.a.createElement("p",null,W),r.a.createElement("p",null,A))),r.a.createElement("div",{className:"col-3 col-md-2"},r.a.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},U.loading&&r.a.createElement(w,null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-3 col-md-8"},U.error&&r.a.createElement(T,null,U.error.message)))))},Y=function(){var e=new URLSearchParams(Object(o.e)().search).get("scope")||"";return r.a.createElement(J,{scope:e})};s.a.render(r.a.createElement(l.a,null,r.a.createElement(u.a,{ReactRouterRoute:o.a},r.a.createElement(Y,null))),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.5674adfb.chunk.js.map